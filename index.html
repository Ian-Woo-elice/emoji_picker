<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Elice Emoji Picker</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap">
    <style>
        :root {
            --bg-color: #ffffff;
            --text-color: #333333;
            --accent-color: #2563eb;
            --border-color: #e5e7eb;
            --hover-bg: #f3f4f6;
            --toast-bg: #333333;
            --toast-text: #ffffff;
            --chip-bg: #e0e7ff;
            --chip-text: #1e40af;
            --chip-hover: #c7d2fe;
        }

        [data-theme="dark"] {
            --bg-color: #111827;
            --text-color: #f9fafb;
            --accent-color: #60a5fa;
            --border-color: #374151;
            --hover-bg: #1f2937;
            --toast-bg: #ffffff;
            --toast-text: #111827;
            --chip-bg: #1e3a8a;
            --chip-text: #dbeafe;
            --chip-hover: #1e40af;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            transition: background-color 0.3s, color 0.3s;
            line-height: 1.5;
            overflow-y: scroll;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            transition: padding 0.3s;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border-color);
            transition: all 0.3s;
        }

        .header-controls { display: flex; gap: 10px; }

        h1 { font-size: 1.25rem; font-weight: 700; }
        
        .icon-btn {
            background: none;
            border: none;
            color: var(--text-color);
            cursor: pointer;
            font-size: 1.1rem;
            padding: 8px;
            border-radius: 8px;
            transition: background 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
        }
        .icon-btn:hover { background-color: var(--hover-bg); }

        .search-wrapper {
            position: sticky;
            top: 0;
            background-color: var(--bg-color);
            padding: 10px 0;
            z-index: 20;
            transition: padding 0.3s;
        }

        .search-box { position: relative; width: 100%; }

        .search-box input {
            width: 100%;
            padding: 14px 20px 14px 44px;
            font-size: 1rem;
            border: 2px solid var(--border-color);
            border-radius: 12px;
            background-color: var(--bg-color);
            color: var(--text-color);
            outline: none;
            transition: border-color 0.2s;
        }

        .search-box input:focus { border-color: var(--accent-color); }

        .search-icon {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: #9ca3af;
        }

        .shortcut-hint {
            position: absolute;
            right: 16px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 0.8rem;
            color: #9ca3af;
            border: 1px solid var(--border-color);
            padding: 2px 6px;
            border-radius: 4px;
            background-color: var(--hover-bg);
        }

        .scenario-container {
            display: flex;
            gap: 8px;
            margin-bottom: 16px;
            overflow-x: auto;
            padding-bottom: 4px;
        }

        .scenario-chip {
            padding: 6px 12px;
            border-radius: 20px;
            background-color: var(--hover-bg);
            color: var(--text-color);
            font-size: 0.85rem;
            cursor: pointer;
            white-space: nowrap;
            border: 1px solid transparent;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .scenario-chip:hover { background-color: var(--border-color); }
        
        .scenario-chip.active {
            background-color: var(--chip-bg);
            color: var(--chip-text);
            border-color: var(--chip-bg);
            font-weight: 600;
        }

        .favorites-bar {
            display: flex;
            gap: 12px;
            overflow-x: auto;
            padding: 8px 0;
            margin-bottom: 16px;
            border-bottom: 1px solid var(--border-color);
            min-height: 45px;
            align-items: center;
        }
        
        .fav-label {
            font-size: 0.8rem;
            color: #9ca3af;
            white-space: nowrap;
            margin-right: 8px;
        }

        .fav-item {
            cursor: pointer;
            font-size: 1.4rem;
            transition: transform 0.1s;
        }
        .fav-item:hover { transform: scale(1.2); }

        .tabs {
            display: flex;
            gap: 6px;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--border-color);
        }

        .tab-btn {
            padding: 10px 16px;
            border: none;
            background: none;
            color: #9ca3af;
            cursor: pointer;
            font-size: 0.95rem;
            position: relative;
            font-weight: 500;
        }

        .tab-btn:hover { color: var(--text-color); }
        .tab-btn.active { color: var(--accent-color); }
        .tab-btn.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 0;
            width: 100%;
            height: 2px;
            background-color: var(--accent-color);
        }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(50px, 1fr));
            gap: 8px;
            padding-bottom: 40px;
        }

        .grid-container.kaomoji-mode {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .grid-item {
            display: flex;
            align-items: center;
            justify-content: center;
            aspect-ratio: 1;
            font-size: 1.8rem;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.1s;
        }

        .grid-item:hover { background-color: var(--hover-bg); }

        .kaomoji-mode .grid-item {
            aspect-ratio: auto;
            padding: 8px 14px;
            font-size: 0.95rem;
            background-color: var(--hover-bg);
            border-radius: 6px;
        }
        .kaomoji-mode .grid-item:hover { background-color: var(--border-color); }

        /* ÎØ∏Îãà Î™®Îìú Ïä§ÌÉÄÏùº */
        body.mini-mode .container { padding: 10px; max-width: 100%; }
        body.mini-mode header { display: none; }
        body.mini-mode .tabs { display: none; }
        body.mini-mode .favorites-bar { margin-bottom: 10px; padding: 4px 0; min-height: 30px; }
        body.mini-mode .fav-item { font-size: 1.2rem; }
        body.mini-mode .search-wrapper { padding: 5px 0 10px 0; }
        body.mini-mode .search-box input { padding: 8px 12px 8px 36px; font-size: 0.9rem; }
        body.mini-mode .search-icon { left: 12px; font-size: 0.8rem; }
        body.mini-mode .shortcut-hint { display: none; }
        body.mini-mode .grid-container { grid-template-columns: repeat(auto-fill, minmax(40px, 1fr)); gap: 4px; }
        body.mini-mode .grid-item { font-size: 1.5rem; }
        
        .mini-exit-btn {
            display: none;
            position: fixed;
            top: 10px;
            right: 10px;
            z-index: 100;
            background: var(--bg-color);
            border: 1px solid var(--border-color);
            border-radius: 50%;
            width: 30px;
            height: 30px;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        body.mini-mode .mini-exit-btn { display: flex; }

        .toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background-color: var(--toast-bg);
            color: var(--toast-text);
            padding: 10px 20px;
            border-radius: 50px;
            font-size: 0.9rem;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            opacity: 0;
            transition: transform 0.3s, opacity 0.3s;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 8px;
            white-space: nowrap;
        }

        .toast.show { transform: translateX(-50%) translateY(0); opacity: 1; }
        
        .loading { text-align: center; padding: 40px; color: #9ca3af; }

        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #d1d5db; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #9ca3af; }
    </style>
</head>
<body>

<button class="mini-exit-btn" id="exitMiniMode" title="ÎØ∏Îãà Î™®Îìú Ï¢ÖÎ£å"><i class="fas fa-expand-alt"></i></button>

<div class="container">
    <header>
        <h1>CX Emoji Pro</h1>
        <div class="header-controls">
            <button class="icon-btn" id="miniModeToggle" title="ÎØ∏Îãà Î™®Îìú"><i class="fas fa-compress-alt"></i></button>
            <button class="icon-btn" id="themeToggle" title="ÌÖåÎßà Î≥ÄÍ≤Ω"><i class="fas fa-moon"></i></button>
        </div>
    </header>

    <div class="search-wrapper">
        <div class="search-box">
            <i class="fas fa-search search-icon"></i>
            <input type="text" id="searchInput" placeholder="Í≤ÄÏÉâ (Ïòà: ÏôÑÎ£å, ÏÇ¨Í≥º, ÌôîÏÇ¥Ìëú)" autocomplete="off">
            <span class="shortcut-hint">/</span>
        </div>
    </div>

    <div class="scenario-container" id="scenarioContainer"></div>

    <div class="favorites-bar" id="favoritesContainer">
        <span class="fav-label"><i class="fas fa-star" style="color: #fbbf24; margin-right:4px;"></i>Ï¶êÍ≤®Ï∞æÍ∏∞</span>
    </div>

    <div class="tabs" id="tabContainer">
        <button class="tab-btn active" data-type="all">Ï†ÑÏ≤¥</button>
        <button class="tab-btn" data-type="emoji">Ïù¥Î™®ÏßÄ</button>
        <button class="tab-btn" data-type="kaomoji">Ïù¥Î™®Ìã∞ÏΩò</button>
        <button class="tab-btn" data-type="special">ÌäπÏàòÍ∏∞Ìò∏</button>
    </div>

    <div id="gridContainer" class="grid-container">
        <div class="loading">Îç∞Ïù¥ÌÑ∞ Î°úÎî© Ï§ë...</div>
    </div>
</div>

<div id="toast" class="toast">
    <i class="fas fa-check-circle"></i>
    <span id="toastMessage">Î≥µÏÇ¨ ÏôÑÎ£å!</span>
</div>

<script>
    // --- Îç∞Ïù¥ÌÑ∞ ÏßÅÏ†ë Ï†ïÏùò (ÎØ∏Î¶¨Î≥¥Í∏∞Ïö©) ---
    // Ïã§Ï†ú Ïö¥ÏòÅ ÏãúÏóêÎäî Ïù¥ Î∞∞Ïó¥Îì§ÏùÑ Ïô∏Î∂Ä JSONÏóêÏÑú Î∂àÎü¨ÏôÄÎèÑ Îê©ÎãàÎã§.
    
    const EMBEDDED_EMOJIS = [
        {emoji: "üòÄ", description: "grinning face", category: "smileys", tags: ["smile", "happy"]},
        {emoji: "üòÉ", description: "grinning face with big eyes", category: "smileys", tags: ["happy", "joy"]},
        {emoji: "üòÑ", description: "grinning face with smiling eyes", category: "smileys", tags: ["happy", "smile"]},
        {emoji: "üòÅ", description: "beaming face with smiling eyes", category: "smileys", tags: ["smile"]},
        {emoji: "üòÜ", description: "grinning squinting face", category: "smileys", tags: ["happy", "laugh"]},
        {emoji: "üòÖ", description: "grinning face with sweat", category: "smileys", tags: ["hot", "sweat"]},
        {emoji: "ü§£", description: "rolling on the floor laughing", category: "smileys", tags: ["lol", "laugh"]},
        {emoji: "üòÇ", description: "face with tears of joy", category: "smileys", tags: ["tears", "cry", "laugh"]},
        {emoji: "üôÇ", description: "slightly smiling face", category: "smileys", tags: ["smile"]},
        {emoji: "üôÉ", description: "upside-down face", category: "smileys", tags: ["silly"]},
        {emoji: "üòâ", description: "winking face", category: "smileys", tags: ["wink"]},
        {emoji: "üòä", description: "smiling face with smiling eyes", category: "smileys", tags: ["blush"]},
        {emoji: "üòá", description: "smiling face with halo", category: "smileys", tags: ["angel"]},
        {emoji: "ü•∞", description: "smiling face with hearts", category: "smileys", tags: ["love"]},
        {emoji: "üòç", description: "smiling face with heart-eyes", category: "smileys", tags: ["love", "crush"]},
        {emoji: "ü§©", description: "star-struck", category: "smileys", tags: ["eyes"]},
        {emoji: "üòò", description: "face blowing a kiss", category: "smileys", tags: ["love", "kiss"]},
        {emoji: "üòó", description: "kissing face", category: "smileys", tags: ["kiss"]},
        {emoji: "üòö", description: "kissing face with closed eyes", category: "smileys", tags: ["kiss"]},
        {emoji: "üòô", description: "kissing face with smiling eyes", category: "smileys", tags: ["kiss"]},
        {emoji: "üòã", description: "face savoring food", category: "smileys", tags: ["yum", "tongue"]},
        {emoji: "üòõ", description: "face with tongue", category: "smileys", tags: ["tongue"]},
        {emoji: "üòú", description: "winking face with tongue", category: "smileys", tags: ["wink", "tongue"]},
        {emoji: "ü§™", description: "zany face", category: "smileys", tags: ["silly"]},
        {emoji: "üòù", description: "squinting face with tongue", category: "smileys", tags: ["tongue"]},
        {emoji: "ü§ë", description: "money-mouth face", category: "smileys", tags: ["rich"]},
        {emoji: "ü§ó", description: "hugging face", category: "smileys", tags: ["hug"]},
        {emoji: "ü§≠", description: "face with hand over mouth", category: "smileys", tags: ["oops"]},
        {emoji: "ü§´", description: "shushing face", category: "smileys", tags: ["quiet"]},
        {emoji: "ü§î", description: "thinking face", category: "smileys", tags: ["think"]},
        {emoji: "ü§ê", description: "zipper-mouth face", category: "smileys", tags: ["silent"]},
        {emoji: "ü§®", description: "face with raised eyebrow", category: "smileys", tags: ["suspicious"]},
        {emoji: "üòê", description: "neutral face", category: "smileys", tags: ["meh"]},
        {emoji: "üòë", description: "expressionless face", category: "smileys", tags: ["meh"]},
        {emoji: "üò∂", description: "face without mouth", category: "smileys", tags: ["silent"]},
        {emoji: "üòè", description: "smirking face", category: "smileys", tags: ["smirk"]},
        {emoji: "üòí", description: "unamused face", category: "smileys", tags: ["meh"]},
        {emoji: "üôÑ", description: "face with rolling eyes", category: "smileys", tags: ["eyeroll"]},
        {emoji: "üò¨", description: "grimacing face", category: "smileys", tags: ["awkward"]},
        {emoji: "ü§•", description: "lying face", category: "smileys", tags: ["liar"]},
        {emoji: "üòå", description: "relieved face", category: "smileys", tags: ["phew"]},
        {emoji: "üòî", description: "pensive face", category: "smileys", tags: ["sad"]},
        {emoji: "üò™", description: "sleepy face", category: "smileys", tags: ["tired"]},
        {emoji: "ü§§", description: "drooling face", category: "smileys", tags: ["yum"]},
        {emoji: "üò¥", description: "sleeping face", category: "smileys", tags: ["sleep"]},
        {emoji: "üò∑", description: "face with medical mask", category: "smileys", tags: ["sick"]},
        {emoji: "ü§í", description: "face with thermometer", category: "smileys", tags: ["sick"]},
        {emoji: "ü§ï", description: "face with head-bandage", category: "smileys", tags: ["hurt"]},
        {emoji: "ü§¢", description: "nauseated face", category: "smileys", tags: ["sick", "barf"]},
        {emoji: "ü§Æ", description: "face vomiting", category: "smileys", tags: ["sick", "barf"]},
        {emoji: "ü§ß", description: "sneezing face", category: "smileys", tags: ["sick"]},
        {emoji: "ü•µ", description: "hot face", category: "smileys", tags: ["hot"]},
        {emoji: "ü•∂", description: "cold face", category: "smileys", tags: ["cold"]},
        {emoji: "ü•¥", description: "woozy face", category: "smileys", tags: ["drunk"]},
        {emoji: "üòµ", description: "dizzy face", category: "smileys", tags: ["dizzy"]},
        {emoji: "ü§Ø", description: "exploding head", category: "smileys", tags: ["mindblown"]},
        {emoji: "ü§†", description: "cowboy hat face", category: "smileys", tags: ["cowboy"]},
        {emoji: "ü•≥", description: "partying face", category: "smileys", tags: ["party"]},
        {emoji: "üòé", description: "smiling face with sunglasses", category: "smileys", tags: ["cool"]},
        {emoji: "ü§ì", description: "nerd face", category: "smileys", tags: ["nerd"]},
        {emoji: "üßê", description: "face with monocle", category: "smileys", tags: ["classy"]},
        {emoji: "üòï", description: "confused face", category: "smileys", tags: ["huh"]},
        {emoji: "üòü", description: "worried face", category: "smileys", tags: ["nervous"]},
        {emoji: "üôÅ", description: "slightly frowning face", category: "smileys", tags: ["sad"]},
        {emoji: "üòÆ", description: "face with open mouth", category: "smileys", tags: ["wow"]},
        {emoji: "üòØ", description: "hushed face", category: "smileys", tags: ["silence"]},
        {emoji: "üò≤", description: "astonished face", category: "smileys", tags: ["omg"]},
        {emoji: "üò≥", description: "flushed face", category: "smileys", tags: ["blush"]},
        {emoji: "ü•∫", description: "pleading face", category: "smileys", tags: ["please"]},
        {emoji: "üò¶", description: "frowning face with open mouth", category: "smileys", tags: ["sad"]},
        {emoji: "üòß", description: "anguished face", category: "smileys", tags: ["sad"]},
        {emoji: "üò®", description: "fearful face", category: "smileys", tags: ["scared"]},
        {emoji: "üò∞", description: "anxious face with sweat", category: "smileys", tags: ["nervous"]},
        {emoji: "üò•", description: "sad but relieved face", category: "smileys", tags: ["phew"]},
        {emoji: "üò¢", description: "crying face", category: "smileys", tags: ["sad", "tear"]},
        {emoji: "üò≠", description: "loudly crying face", category: "smileys", tags: ["sad", "cry"]},
        {emoji: "üò±", description: "face screaming in fear", category: "smileys", tags: ["scared", "omg"]},
        {emoji: "üòñ", description: "confounded face", category: "smileys", tags: ["annoyed"]},
        {emoji: "üò£", description: "persevering face", category: "smileys", tags: ["struggle"]},
        {emoji: "üòû", description: "disappointed face", category: "smileys", tags: ["sad"]},
        {emoji: "üòì", description: "downcast face with sweat", category: "smileys", tags: ["nervous"]},
        {emoji: "üò©", description: "weary face", category: "smileys", tags: ["tired"]},
        {emoji: "üò´", description: "tired face", category: "smileys", tags: ["exhausted"]},
        {emoji: "ü•±", description: "yawning face", category: "smileys", tags: ["sleep"]},
        {emoji: "üò§", description: "face with steam from nose", category: "smileys", tags: ["angry"]},
        {emoji: "üò°", description: "pouting face", category: "smileys", tags: ["mad"]},
        {emoji: "üò†", description: "angry face", category: "smileys", tags: ["mad"]},
        {emoji: "ü§¨", description: "face with symbols on mouth", category: "smileys", tags: ["swearing"]},
        {emoji: "üòà", description: "smiling face with horns", category: "smileys", tags: ["devil"]},
        {emoji: "üëø", description: "angry face with horns", category: "smileys", tags: ["devil"]},
        {emoji: "üíÄ", description: "skull", category: "smileys", tags: ["dead"]},
        {emoji: "üëã", description: "waving hand", category: "people", tags: ["hello", "bye"]},
        {emoji: "ü§ö", description: "raised back of hand", category: "people", tags: ["stop"]},
        {emoji: "üñê", description: "hand with fingers splayed", category: "people", tags: ["highfive"]},
        {emoji: "‚úã", description: "raised hand", category: "people", tags: ["stop", "highfive"]},
        {emoji: "üññ", description: "vulcan salute", category: "people", tags: ["prosper"]},
        {emoji: "üëå", description: "OK hand", category: "people", tags: ["perfect"]},
        {emoji: "ü§è", description: "pinching hand", category: "people", tags: ["small"]},
        {emoji: "‚úåÔ∏è", description: "victory hand", category: "people", tags: ["peace"]},
        {emoji: "ü§û", description: "crossed fingers", category: "people", tags: ["luck"]},
        {emoji: "ü§ü", description: "love-you gesture", category: "people", tags: ["love"]},
        {emoji: "ü§ò", description: "sign of the horns", category: "people", tags: ["rock"]},
        {emoji: "ü§ô", description: "call me hand", category: "people", tags: ["phone"]},
        {emoji: "üëà", description: "backhand index pointing left", category: "people", tags: ["point"]},
        {emoji: "üëâ", description: "backhand index pointing right", category: "people", tags: ["point"]},
        {emoji: "üëÜ", description: "backhand index pointing up", category: "people", tags: ["point"]},
        {emoji: "üëá", description: "backhand index pointing down", category: "people", tags: ["point"]},
        {emoji: "üëç", description: "thumbs up", category: "people", tags: ["approve"]},
        {emoji: "üëé", description: "thumbs down", category: "people", tags: ["disapprove"]},
        {emoji: "üëä", description: "oncoming fist", category: "people", tags: ["punch"]},
        {emoji: "üëè", description: "clapping hands", category: "people", tags: ["applause"]},
        {emoji: "üôå", description: "raising hands", category: "people", tags: ["celebrate"]},
        {emoji: "üëê", description: "open hands", category: "people", tags: ["hug"]},
        {emoji: "ü§≤", description: "palms up together", category: "people", tags: ["pray"]},
        {emoji: "ü§ù", description: "handshake", category: "people", tags: ["deal"]},
        {emoji: "üôè", description: "folded hands", category: "people", tags: ["please", "pray"]},
        {emoji: "üôá‚Äç‚ôÇÔ∏è", description: "person bowing", category: "people", tags: ["sorry"]},
        {emoji: "üôã‚Äç‚ôÇÔ∏è", description: "person raising hand", category: "people", tags: ["question"]},
        {emoji: "üôÜ‚Äç‚ôÇÔ∏è", description: "person gesturing OK", category: "people", tags: ["ok"]},
        {emoji: "üôÖ‚Äç‚ôÇÔ∏è", description: "person gesturing NO", category: "people", tags: ["no"]},
        {emoji: "‚úÖ", description: "check mark button", category: "symbols", tags: ["check"]},
        {emoji: "‚òëÔ∏è", description: "check box with check", category: "symbols", tags: ["check"]},
        {emoji: "‚úîÔ∏è", description: "check mark", category: "symbols", tags: ["check"]},
        {emoji: "‚ùå", description: "cross mark", category: "symbols", tags: ["no"]},
        {emoji: "‚ùé", description: "cross mark button", category: "symbols", tags: ["no"]},
        {emoji: "üíØ", description: "hundred points", category: "symbols", tags: ["perfect"]},
        {emoji: "üí¢", description: "anger symbol", category: "symbols", tags: ["angry"]},
        {emoji: "üí•", description: "collision", category: "symbols", tags: ["boom"]},
        {emoji: "üí´", description: "dizzy", category: "symbols", tags: ["star"]},
        {emoji: "üí¶", description: "sweat droplets", category: "symbols", tags: ["water"]},
        {emoji: "üí®", description: "dashing away", category: "symbols", tags: ["fast"]},
        {emoji: "üï≥", description: "hole", category: "symbols", tags: ["void"]},
        {emoji: "üí£", description: "bomb", category: "objects", tags: ["boom"]},
        {emoji: "üí¨", description: "speech balloon", category: "symbols", tags: ["talk"]},
        {emoji: "üëÅÔ∏è‚Äçüó®Ô∏è", description: "eye in speech bubble", category: "symbols", tags: ["witness"]},
        {emoji: "üó®Ô∏è", description: "left speech bubble", category: "symbols", tags: ["talk"]},
        {emoji: "üóØÔ∏è", description: "right anger bubble", category: "symbols", tags: ["mad"]},
        {emoji: "üí≠", description: "thought balloon", category: "symbols", tags: ["think"]},
        {emoji: "üí§", description: "zzz", category: "symbols", tags: ["sleep"]},
        {emoji: "üéâ", description: "party popper", category: "objects", tags: ["celebrate"]},
        {emoji: "‚ú®", description: "sparkles", category: "objects", tags: ["shiny"]},
        {emoji: "‚≠ê", description: "star", category: "objects", tags: ["shiny"]},
        {emoji: "üêõ", description: "bug", category: "animals", tags: ["error"]},
        {emoji: "üîß", description: "wrench", category: "objects", tags: ["fix"]},
        {emoji: "üö®", description: "police car light", category: "objects", tags: ["alert"]},
        {emoji: "‚ö†Ô∏è", description: "warning", category: "symbols", tags: ["alert"]},
        {emoji: "üõë", description: "stop sign", category: "symbols", tags: ["stop"]},
        {emoji: "üì¢", description: "loudspeaker", category: "objects", tags: ["announce"]},
        {emoji: "üí°", description: "light bulb", category: "objects", tags: ["idea"]},
        {emoji: "üìå", description: "pushpin", category: "objects", tags: ["pin"]},
        {emoji: "üìç", description: "round pushpin", category: "objects", tags: ["pin"]},
        {emoji: "‚û°Ô∏è", description: "right arrow", category: "symbols", tags: ["arrow"]},
        {emoji: "üëâ", description: "backhand index pointing right", category: "people", tags: ["arrow"]},
        {emoji: "üëá", description: "backhand index pointing down", category: "people", tags: ["arrow"]},
        {emoji: "‚è©", description: "fast-forward button", category: "symbols", tags: ["arrow"]},
        {emoji: "‚ñ∂Ô∏è", description: "play button", category: "symbols", tags: ["arrow"]},
        {emoji: "üîú", description: "SOON arrow", category: "symbols", tags: ["arrow"]},
        {emoji: "üîº", description: "up button", category: "symbols", tags: ["arrow"]},
        {emoji: "üîΩ", description: "down button", category: "symbols", tags: ["arrow"]},
        {emoji: "‚≠ï", description: "hollow red circle", category: "symbols", tags: ["yes"]},
        {emoji: "üö´", description: "prohibited", category: "symbols", tags: ["no"]},
        {emoji: "üìõ", description: "name badge", category: "objects", tags: ["name"]},
        {emoji: "üíñ", description: "sparkling heart", category: "symbols", tags: ["love"]},
        {emoji: "üëë", description: "crown", category: "objects", tags: ["king"]},
        {emoji: "üéà", description: "balloon", category: "objects", tags: ["celebrate"]},
        {emoji: "üîç", description: "magnifying glass left", category: "objects", tags: ["search"]},
        {emoji: "üÜó", description: "OK button", category: "symbols", tags: ["yes"]}
    ];

    const EMBEDDED_KAOMOJIS = [
        {emoji: "( ‚Ä¢ÃÄ œâ ‚Ä¢ÃÅ )‚úß", description: "confident", tags: ["happy"]},
        {emoji: "( Ôæâ ÔæüÔΩ∞Ôæü)Ôæâ", description: "hooray", tags: ["party"]},
        {emoji: "(*Ôø£3Ôø£)‚ï≠", description: "kiss", tags: ["love"]},
        {emoji: "(u‚Äø‡∏∫u‚úø‡∏∫)", description: "peaceful", tags: ["sleep"]},
        {emoji: "(‚úø‚ó°‚Äø‚ó°)", description: "shy", tags: ["happy"]},
        {emoji: "(*/œâÔºº*)", description: "embarrassed", tags: ["shy"]},
        {emoji: "œÜ(„Çú‚ñΩ„Çú*)‚ô™", description: "writing", tags: ["study"]},
        {emoji: "(‚âß‚àá‚â¶)Ôæâ", description: "excited", tags: ["happy"]},
        {emoji: "‚ï∞(*¬∞‚ñΩ¬∞*)‚ïØ", description: "joy", tags: ["happy"]},
        {emoji: "( ¬¥ÔΩ•ÔΩ•)Ôæâ(._.`)", description: "comfort", tags: ["sad"]},
        {emoji: "o(*Ôø£‚ñΩÔø£*)„Éñ", description: "hello", tags: ["greet"]},
        {emoji: "(‚î¨‚î¨Ôπè‚î¨‚î¨)", description: "crying", tags: ["sad"]},
        {emoji: "‡≤†_‡≤†", description: "disapproval", tags: ["mad"]},
        {emoji: "(‚ïØ¬∞‚ñ°¬∞Ôºâ‚ïØÔ∏µ ‚îª‚îÅ‚îª", description: "flip table", tags: ["angry"]},
        {emoji: "‚î¨‚îÄ‚î¨„Éé( ¬∫ _ ¬∫„Éé)", description: "put table back", tags: ["calm"]},
        {emoji: "¬Ø\\_(„ÉÑ)_/¬Ø", description: "shrug", tags: ["dunno"]},
        {emoji: "(‚ù§¬¥Ëâ∏ÔΩÄ‚ù§)", description: "love", tags: ["love"]},
        {emoji: "‚è≤_‚è≤", description: "waiting", tags: ["bored"]},
        {emoji: "‚îó( TÔπèT )‚îõ", description: "surrender", tags: ["sad"]},
        {emoji: "OwO", description: "owo", tags: ["cute"]},
        {emoji: "UwU", description: "uwu", tags: ["cute"]},
        {emoji: "(* Ôø£3)(ŒµÔø£ *)", description: "kissing", tags: ["love"]},
        {emoji: "(ÔΩûÔø£(OO)Ôø£)„Éñ", description: "pig", tags: ["animal"]}
    ];

    const EMBEDDED_SPECIALS = [
        {emoji: "‚Üí", description: "arrow right", tags: ["arrow"]},
        {emoji: "‚Üê", description: "arrow left", tags: ["arrow"]},
        {emoji: "‚Üë", description: "arrow up", tags: ["arrow"]},
        {emoji: "‚Üì", description: "arrow down", tags: ["arrow"]},
        {emoji: "‚òÖ", description: "black star", tags: ["star"]},
        {emoji: "‚òÜ", description: "white star", tags: ["star"]},
        {emoji: "‚òé", description: "telephone", tags: ["phone"]},
        {emoji: "‚òû", description: "finger pointing right", tags: ["point"]},
        {emoji: "‚Äª", description: "reference mark", tags: ["note"]},
        {emoji: "‚Ä†", description: "dagger", tags: ["symbol"]},
        {emoji: "‚Ä°", description: "double dagger", tags: ["symbol"]},
        {emoji: "‚ÑÉ", description: "celsius", tags: ["unit"]},
        {emoji: "‚Ñâ", description: "fahrenheit", tags: ["unit"]},
        {emoji: "‚Ñ¢", description: "trademark", tags: ["symbol"]},
        {emoji: "¬©", description: "copyright", tags: ["symbol"]},
        {emoji: "¬Æ", description: "registered", tags: ["symbol"]},
        {emoji: "‚úì", description: "check", tags: ["check"]},
        {emoji: "‚úï", description: "cross", tags: ["no"]}
    ];

    const scenarios = [
        { id: 'apology', label: 'üôá‚Äç‚ôÇÔ∏è ÏÇ¨Í≥º/Ïò§Î•ò', icon: 'fas fa-wrench', emojis: ['üôá‚Äç‚ôÇÔ∏è', 'üôè', 'üò¢', 'üí¶', 'üîß', 'üö®', '‚ö†Ô∏è', 'üêõ', 'üî®'] },
        { id: 'welcome', label: 'üéâ ÌôòÏòÅ/Ïπ≠Ï∞¨', icon: 'fas fa-party-horn', emojis: ['üéâ', 'ü•≥', 'üëã', '‚ú®', 'üéÅ', 'üôå', 'üëè', 'üíñ', 'üëë', 'üéà'] },
        { id: 'check', label: '‚úÖ ÌôïÏù∏/Í∞ïÏ°∞', icon: 'fas fa-check-double', emojis: ['‚úÖ', 'üëå', 'üì¢', 'üí°', 'üìå', '‚û°Ô∏è', '‚≠ê', '‚úîÔ∏è', 'üÜó', 'üîç'] },
        { id: 'yes', label: '‚≠ï Í∏çÏ†ï/ÎèôÏùò', icon: 'fas fa-thumbs-up', emojis: ['‚≠ï', 'üôÜ‚Äç‚ôÇÔ∏è', 'üëç', 'ü§ù', 'üÜó', 'ü•∞', 'üíñ'] },
        { id: 'no', label: '‚ùå Î∂ÄÏ†ï/Í±∞Ï†à', icon: 'fas fa-ban', emojis: ['‚ùå', 'üôÖ‚Äç‚ôÇÔ∏è', 'üëé', '‚úã', 'üö´', 'üìõ', 'üí¢'] },
        { id: 'arrow', label: '‚û°Ô∏è ÌôîÏÇ¥Ìëú', icon: 'fas fa-arrow-right', emojis: ['‚û°Ô∏è', 'üëâ', 'üëá', '‚è©', '‚ñ∂Ô∏è', 'üîú', 'üîº', 'üîΩ'] }
    ];

    const keywordMapping = {
        '‚úÖ': ['ÏôÑÎ£å', 'Ï≤¥ÌÅ¨', 'Ìï¥Í≤∞', 'ÏÑ±Í≥µ', 'v'],
        '‚úîÔ∏è': ['ÏôÑÎ£å', 'Ï≤¥ÌÅ¨', 'v'],
        'üëå': ['Ïò§ÏºÄÏù¥', 'Ï¢ãÏïÑ', 'Í∞ÄÎä•', 'ÌôïÏù∏', 'ok'],
        'üôÜ‚Äç‚ôÇÔ∏è': ['Ïò§ÏºÄÏù¥', 'Í∞ÄÎä•', 'ÎèôÏùò', 'Î™∏'],
        '‚≠ï': ['ÎèôÍ∑∏ÎùºÎØ∏', 'Í∞ÄÎä•', 'Ï†ïÎãµ'],
        '‚ùå': ['ÏóëÏä§', 'Î∂àÍ∞Ä', 'Ï∑®ÏÜå', 'Í±∞Ï†à', 'Ïò§Î•ò'],
        'üö´': ['Í∏àÏßÄ', 'Î∂àÍ∞Ä'],
        'üêõ': ['Î≤ÑÍ∑∏', 'Î≤åÎ†à', 'Ïò§Î•ò', 'ÏóêÎü¨', 'Í≥†Ïû•'],
        'üö®': ['ÏÇ¨Ïù¥Î†å', 'Í∏¥Í∏â', 'ÏóêÎü¨', 'Í≤ΩÍ≥†', 'Ï§ëÏöî'],
        '‚ö†Ô∏è': ['Ï£ºÏùò', 'Í≤ΩÍ≥†', 'ÏúÑÌóò'],
        'üîß': ['ÏàòÎ¶¨', 'Í≥†ÏπòÎäî', 'ÎèÑÍµ¨', 'ÏÑ§Ï†ï', 'Ï†ïÎπÑ'],
        'üôè': ['Î∂ÄÌÉÅ', 'Ï†úÎ∞ú', 'Í∞êÏÇ¨', 'Í∏∞ÎèÑ', 'Ï£ÑÏÜ°', 'ÏÇ¨Í≥º'],
        'üôá‚Äç‚ôÇÔ∏è': ['ÏÇ¨Í≥º', 'Ï†à', 'Ï£ÑÏÜ°', 'Î∂ÄÌÉÅ'],
        'üò¢': ['ÎààÎ¨º', 'Ïä¨Ìîî', 'Ï£ÑÏÜ°', 'Ïö∏Ïùå'],
        'üí¶': ['ÎïÄ', 'ÎãπÌô©', 'Ï£ÑÏÜ°'],
        'üéâ': ['Ï∂ïÌïò', 'ÌååÌã∞', 'Ìè≠Ï£Ω', 'ÌôòÏòÅ'],
        'ü•≥': ['ÌååÌã∞', 'Ï∂ïÌïò', 'ÌñâÎ≥µ'],
        'üëã': ['ÏïàÎÖï', 'Ïù∏ÏÇ¨', 'ÏÜê'],
        'üí°': ['ÌåÅ', 'ÏïÑÏù¥ÎîîÏñ¥', 'Ï†ÑÍµ¨', 'ÏïåÎ¶º', 'Ï∞∏Í≥†'],
        'üì¢': ['Í≥µÏßÄ', 'ÌôïÏÑ±Í∏∞', 'ÏïåÎ¶º', 'ÏÜåÎ¶¨'],
        'üìå': ['ÌïÄ', 'Í≥†Ï†ï', 'Ï§ëÏöî', 'Ï∞∏Í≥†'],
        'üìç': ['ÏúÑÏπò', 'ÌïÄ'],
        '‚≠ê': ['Î≥Ñ', 'Ï§ëÏöî', 'Ïä§ÌÉÄ', 'Ï¶êÍ≤®Ï∞æÍ∏∞'],
        '‚ú®': ['Î∞òÏßù', 'ÏÉàÍ±∞', 'Í∞ïÏ°∞'],
        'üëç': ['ÏµúÍ≥†', 'Îî∞Î¥â', 'Ï¢ãÏïÑÏöî', 'Íµø'],
        'üëé': ['ÎπÑÏ∂î', 'Î≥ÑÎ°ú', 'Ïã´Ïñ¥Ïöî'],
        '‚ù§Ô∏è': ['ÌïòÌä∏', 'ÏÇ¨Îûë', 'Ï¢ãÏïÑÏöî'],
        '‚úâÔ∏è': ['Î©îÏùº', 'Ìé∏ÏßÄ', 'Ïó∞ÎùΩ'],
        'üìû': ['Ï†ÑÌôî', 'Ïó∞ÎùΩ', 'ÏàòÌôîÍ∏∞']
    };

    const state = {
        allData: [],
        filterTab: 'all',
        activeScenario: null,
        searchTerm: '',
        favorites: JSON.parse(localStorage.getItem('cx_emoji_favorites') || '[]'),
        isMiniMode: false
    };

    const gridContainer = document.getElementById('gridContainer');
    const searchInput = document.getElementById('searchInput');

    async function init() {
        renderScenarios();
        renderFavorites();
        setupEventListeners();
        
        // ÎØ∏Î¶¨Î≥¥Í∏∞Ïö© Îç∞Ïù¥ÌÑ∞ ÌÜµÌï©
        let data = [];
        data.push(...EMBEDDED_EMOJIS.map(i => ({...i, type: 'emoji'})));
        data.push(...EMBEDDED_KAOMOJIS.map(i => ({...i, type: 'kaomoji'})));
        data.push(...EMBEDDED_SPECIALS.map(i => ({...i, type: 'special'})));

        // Ïú†ÏùòÏñ¥ Ï£ºÏûÖ
        state.allData = data.map(item => {
            const keywords = keywordMapping[item.emoji] || [];
            return { ...item, keywords };
        });

        filterAndRender();

        const savedTheme = localStorage.getItem('cx_emoji_theme');
        if (savedTheme) applyTheme(savedTheme);
    }

    // --- Î†åÎçîÎßÅ Î°úÏßÅ (Í∏∞Ï°¥Í≥º ÎèôÏùº) ---
    function renderScenarios() {
        const container = document.getElementById('scenarioContainer');
        container.innerHTML = '';
        scenarios.forEach(sc => {
            const btn = document.createElement('div');
            btn.className = 'scenario-chip';
            if (state.activeScenario === sc.id) btn.classList.add('active');
            btn.innerHTML = `<span>${sc.label}</span>`;
            btn.onclick = () => toggleScenario(sc.id);
            container.appendChild(btn);
        });
    }

    function filterAndRender() {
        let result = state.allData;

        if (state.activeScenario) {
            const scenario = scenarios.find(s => s.id === state.activeScenario);
            if (scenario) {
                result = scenario.emojis.map(char => {
                    const found = state.allData.find(d => d.emoji === char);
                    return found || { emoji: char, type: 'emoji', description: 'Scenario Item' };
                });
            }
        } else {
            if (state.filterTab !== 'all') {
                result = result.filter(item => item.type === state.filterTab);
            }
            if (state.searchTerm) {
                const term = state.searchTerm.toLowerCase();
                result = result.filter(item => {
                    const desc = (item.description || '').toLowerCase();
                    const tags = (item.tags || []).join(' ').toLowerCase();
                    const keywords = (item.keywords || []).join(' ');
                    return desc.includes(term) || tags.includes(term) || item.emoji.includes(term) || keywords.includes(term);
                });
            }
        }
        renderGridItems(result);
    }

    function renderGridItems(items) {
        gridContainer.innerHTML = '';
        const isKaomojiMode = state.filterTab === 'kaomoji' || (items.length > 0 && items[0].type === 'kaomoji');
        
        if (isKaomojiMode) gridContainer.classList.add('kaomoji-mode');
        else gridContainer.classList.remove('kaomoji-mode');

        const fragment = document.createDocumentFragment();
        const limit = state.searchTerm ? 1000 : 300;

        items.slice(0, limit).forEach(item => {
            const div = document.createElement('div');
            div.className = 'grid-item';
            div.textContent = item.emoji;
            div.onclick = () => copyToClipboard(item.emoji);
            let tooltip = item.description || '';
            if (item.keywords && item.keywords.length > 0) tooltip += ` (${item.keywords.join(', ')})`;
            div.title = tooltip;
            fragment.appendChild(div);
        });

        if (items.length === 0) gridContainer.innerHTML = '<div class="loading">Í≤ÄÏÉâ Í≤∞Í≥ºÍ∞Ä ÏóÜÏäµÎãàÎã§.</div>';
        else gridContainer.appendChild(fragment);
    }

    function toggleScenario(id) {
        if (state.activeScenario === id) {
            state.activeScenario = null;
        } else {
            state.activeScenario = id;
            state.searchTerm = '';
            searchInput.value = '';
        }
        renderScenarios();
        filterAndRender();
    }

    function renderFavorites() {
        const container = document.getElementById('favoritesContainer');
        while (container.children.length > 1) container.removeChild(container.lastChild);
        state.favorites.forEach(emoji => {
            const span = document.createElement('span');
            span.className = 'fav-item';
            span.textContent = emoji;
            span.onclick = () => copyToClipboard(emoji);
            container.appendChild(span);
        });
    }

    async function copyToClipboard(text) {
        try {
            await navigator.clipboard.writeText(text);
            showToast(text);
            addToFavorites(text);
        } catch (err) {
            const ta = document.createElement('textarea');
            ta.value = text;
            document.body.appendChild(ta);
            ta.select();
            document.execCommand('copy');
            document.body.removeChild(ta);
            showToast(text);
            addToFavorites(text);
        }
    }

    function showToast(text) {
        const t = document.getElementById('toast');
        const msg = document.getElementById('toastMessage');
        msg.textContent = `"${text}" Î≥µÏÇ¨Îê®`;
        t.classList.add('show');
        if(t.timer) clearTimeout(t.timer);
        t.timer = setTimeout(() => t.classList.remove('show'), 1500);
    }

    function addToFavorites(emoji) {
        let news = state.favorites.filter(e => e !== emoji);
        news.unshift(emoji);
        if (news.length > 15) news.pop();
        state.favorites = news;
        localStorage.setItem('cx_emoji_favorites', JSON.stringify(news));
        renderFavorites();
    }

    function toggleMiniMode() {
        state.isMiniMode = !state.isMiniMode;
        if (state.isMiniMode) document.body.classList.add('mini-mode');
        else document.body.classList.remove('mini-mode');
    }

    function applyTheme(theme) {
        document.documentElement.setAttribute('data-theme', theme);
        const icon = document.querySelector('#themeToggle i');
        if(theme === 'dark') icon.className = 'fas fa-sun';
        else icon.className = 'fas fa-moon';
    }

    function setupEventListeners() {
        document.getElementById('miniModeToggle').addEventListener('click', toggleMiniMode);
        document.getElementById('exitMiniMode').addEventListener('click', toggleMiniMode);
        document.getElementById('themeToggle').addEventListener('click', () => {
            const current = document.documentElement.getAttribute('data-theme');
            const next = current === 'dark' ? 'light' : 'dark';
            applyTheme(next);
            localStorage.setItem('cx_emoji_theme', next);
        });
        document.getElementById('tabContainer').addEventListener('click', (e) => {
            if(e.target.classList.contains('tab-btn')) {
                document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
                e.target.classList.add('active');
                state.filterTab = e.target.dataset.type;
                state.activeScenario = null;
                renderScenarios();
                filterAndRender();
            }
        });
        let debounce;
        searchInput.addEventListener('input', (e) => {
            clearTimeout(debounce);
            debounce = setTimeout(() => {
                state.searchTerm = e.target.value;
                state.activeScenario = null;
                renderScenarios();
                filterAndRender();
            }, 200);
        });
        document.addEventListener('keydown', (e) => {
            if(e.key === '/' && document.activeElement !== searchInput) {
                e.preventDefault();
                searchInput.focus();
            }
            if(e.key === 'Escape' && state.isMiniMode) {
                toggleMiniMode();
            }
        });
    }

    init();
</script>
</body>
</html>
